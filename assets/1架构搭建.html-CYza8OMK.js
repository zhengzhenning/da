import{_ as o,r as p,o as i,c as r,a as n,b as s,d as t,e}from"./app-DkUy9m5s.js";const l={},c=n("div",{class:"hint-container important"},[n("p",{class:"hint-container-title"},"重要"),n("p",null,[s("通过 "),n("code",null,"sqshq/piggymetrics"),s(" 学习和了解微服务架构")]),n("p",null,"Microservice Architecture with Spring Boot, Spring Cloud and Docker")],-1),u={href:"https://github.com/sqshq/piggymetrics",target:"_blank",rel:"noopener noreferrer"},d=n("code",null,"sqshq/piggymetrics",-1),m=n("ol",null,[n("li",null,"本地启动项目"),n("li",null,"容器化部署项目")],-1),g=n("p",null,"参考资料：",-1),k={href:"https://www.yuanqingfei.com/2021-12-27%20%E5%AD%A6%E4%B9%A0Spring%20Cloud%E4%B9%8B%E6%9C%AC%E5%9C%B0%E9%83%A8%E7%BD%B2/",target:"_blank",rel:"noopener noreferrer"},v=e('<h1 id="版本说明" tabindex="-1"><a class="header-anchor" href="#版本说明"><span>版本说明</span></a></h1><p>版本适配是项目首要关注点，关乎环境搭建。</p><p>版本会随着语言、组件、框架等的升级，造成项目与版本不相适配的潜在问题，进而导致项目工程无法启动、部署。因此，对于任何一个工程项目，应优先关注版本适配问题。</p><table><thead><tr><th style="text-align:center;">组件/语言/框架/工具</th><th style="text-align:center;">版本</th></tr></thead><tbody><tr><td style="text-align:center;">Java</td><td style="text-align:center;"><code>8</code></td></tr><tr><td style="text-align:center;">SpringBoot</td><td style="text-align:center;"><code>2.0.3.RELEASE</code></td></tr><tr><td style="text-align:center;">SpringCloud</td><td style="text-align:center;"><code>Finchley.RELEASE</code></td></tr><tr><td style="text-align:center;">MongoDB</td><td style="text-align:center;"><code>5.0.5</code></td></tr><tr><td style="text-align:center;">RabbitMQ</td><td style="text-align:center;"><code>3.9.11</code></td></tr><tr><td style="text-align:center;">IDEA</td><td style="text-align:center;"><code>2022.3.1</code></td></tr></tbody></table>',4),b={href:"https://docs.spring.io/spring-data/mongodb/docs/3.2.4/reference/html/#preface",target:"_blank",rel:"noopener noreferrer"},h={href:"https://docs.spring.io/spring-data/mongodb/docs/3.2.4/reference/html/#compatibility.matrix",target:"_blank",rel:"noopener noreferrer"},q=e(`<h1 id="本地启动项目" tabindex="-1"><a class="header-anchor" href="#本地启动项目"><span>本地启动项目</span></a></h1><h2 id="环境准备" tabindex="-1"><a class="header-anchor" href="#环境准备"><span>环境准备</span></a></h2><h3 id="部署-mongdb" tabindex="-1"><a class="header-anchor" href="#部署-mongdb"><span>部署 MongDB</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># 安装</span>
<span class="token function">docker</span> pull mongodb:latest
<span class="token comment"># 运行</span>
<span class="token function">docker</span> run <span class="token parameter variable">-itd</span> <span class="token parameter variable">--name</span> mongodb <span class="token parameter variable">-p</span> <span class="token number">27017</span>:27017 mongo:latest <span class="token parameter variable">--auth</span>
<span class="token comment"># 进容器</span>
<span class="token function">docker</span> <span class="token function">ps</span> 
<span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> 镜像ID /bin/bash
<span class="token comment"># 登录</span>
mongo 
<span class="token comment"># 查看当前数据库，确认是否为 piggymetrics 库</span>
db
<span class="token comment"># 切换到 piggymetrics 库</span>
use piggymetrics
<span class="token comment"># 添加数据库用户</span>
db.createUser<span class="token punctuation">(</span>
  <span class="token punctuation">{</span>
    user: <span class="token string">&quot;user&quot;</span>,
    pwd: <span class="token string">&quot;password&quot;</span>,
    roles: <span class="token punctuation">[</span> <span class="token punctuation">{</span> role: <span class="token string">&quot;root&quot;</span>, db: <span class="token string">&quot;admin&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
<span class="token comment"># 使用 db.getUser 或 db.auth 验证</span>
db.getUser<span class="token punctuation">(</span><span class="token string">&#39;user&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
db.auth<span class="token punctuation">(</span><span class="token string">&#39;user&#39;</span>,<span class="token string">&#39;password&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>执行数据初始化脚本：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// 初始化数据 account-service-dump.js</span>
db<span class="token punctuation">.</span>accounts<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>
    <span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;demo&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;demo&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;lastSeen&quot;</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;note&quot;</span><span class="token operator">:</span> <span class="token string">&quot;demo note&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;expenses&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token string-property property">&quot;amount&quot;</span><span class="token operator">:</span> <span class="token number">1300</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;currency&quot;</span><span class="token operator">:</span> <span class="token string">&quot;USD&quot;</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;icon&quot;</span><span class="token operator">:</span> <span class="token string">&quot;home&quot;</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;period&quot;</span><span class="token operator">:</span> <span class="token string">&quot;MONTH&quot;</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Rent&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token string-property property">&quot;amount&quot;</span><span class="token operator">:</span> <span class="token number">120</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;currency&quot;</span><span class="token operator">:</span> <span class="token string">&quot;USD&quot;</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;icon&quot;</span><span class="token operator">:</span> <span class="token string">&quot;utilities&quot;</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;period&quot;</span><span class="token operator">:</span> <span class="token string">&quot;MONTH&quot;</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Utilities&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token string-property property">&quot;amount&quot;</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;currency&quot;</span><span class="token operator">:</span> <span class="token string">&quot;USD&quot;</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;icon&quot;</span><span class="token operator">:</span> <span class="token string">&quot;meal&quot;</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;period&quot;</span><span class="token operator">:</span> <span class="token string">&quot;DAY&quot;</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Meal&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token string-property property">&quot;amount&quot;</span><span class="token operator">:</span> <span class="token number">240</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;currency&quot;</span><span class="token operator">:</span> <span class="token string">&quot;USD&quot;</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;icon&quot;</span><span class="token operator">:</span> <span class="token string">&quot;gas&quot;</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;period&quot;</span><span class="token operator">:</span> <span class="token string">&quot;MONTH&quot;</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Gas&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token string-property property">&quot;amount&quot;</span><span class="token operator">:</span> <span class="token number">3500</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;currency&quot;</span><span class="token operator">:</span> <span class="token string">&quot;EUR&quot;</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;icon&quot;</span><span class="token operator">:</span> <span class="token string">&quot;island&quot;</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;period&quot;</span><span class="token operator">:</span> <span class="token string">&quot;YEAR&quot;</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Vacation&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token string-property property">&quot;amount&quot;</span><span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;currency&quot;</span><span class="token operator">:</span> <span class="token string">&quot;EUR&quot;</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;icon&quot;</span><span class="token operator">:</span> <span class="token string">&quot;phone&quot;</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;period&quot;</span><span class="token operator">:</span> <span class="token string">&quot;MONTH&quot;</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Phone&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token string-property property">&quot;amount&quot;</span><span class="token operator">:</span> <span class="token number">700</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;currency&quot;</span><span class="token operator">:</span> <span class="token string">&quot;USD&quot;</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;icon&quot;</span><span class="token operator">:</span> <span class="token string">&quot;sport&quot;</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;period&quot;</span><span class="token operator">:</span> <span class="token string">&quot;YEAR&quot;</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Gym&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;incomes&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token string-property property">&quot;amount&quot;</span><span class="token operator">:</span> <span class="token number">42000</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;currency&quot;</span><span class="token operator">:</span> <span class="token string">&quot;USD&quot;</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;icon&quot;</span><span class="token operator">:</span> <span class="token string">&quot;wallet&quot;</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;period&quot;</span><span class="token operator">:</span> <span class="token string">&quot;YEAR&quot;</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Salary&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token string-property property">&quot;amount&quot;</span><span class="token operator">:</span> <span class="token number">500</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;currency&quot;</span><span class="token operator">:</span> <span class="token string">&quot;USD&quot;</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;icon&quot;</span><span class="token operator">:</span> <span class="token string">&quot;edu&quot;</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;period&quot;</span><span class="token operator">:</span> <span class="token string">&quot;MONTH&quot;</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Scholarship&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;saving&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string-property property">&quot;amount&quot;</span><span class="token operator">:</span> <span class="token number">5900</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;capitalization&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;currency&quot;</span><span class="token operator">:</span> <span class="token string">&quot;USD&quot;</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;deposit&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;interest&quot;</span><span class="token operator">:</span> <span class="token number">3.32</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">upsert</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>部署成功：</p><figure><img src="https://cdn.jsdelivr.net/gh/zhengzhenning/imageBeds@main/images/image-20240424111519244.png" alt="容器运行情况" tabindex="0" loading="lazy"><figcaption>容器运行情况</figcaption></figure><p>数据初始化成功：</p><figure><img src="https://cdn.jsdelivr.net/gh/zhengzhenning/imageBeds@main/images/image-20240424110722680.png" alt="accounts表数据初始化情况" tabindex="0" loading="lazy"><figcaption>accounts表数据初始化情况</figcaption></figure><h3 id="部署-rabbitmq" tabindex="-1"><a class="header-anchor" href="#部署-rabbitmq"><span>部署 RabbitMQ</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">#安装</span>
<span class="token function">docker</span> pull rabbitmq:latest

<span class="token comment">#运行</span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">--hostname</span> rabbitmq <span class="token parameter variable">--name</span> rabbit <span class="token parameter variable">-p</span> <span class="token number">15672</span>:15672 <span class="token parameter variable">-p</span> <span class="token number">5672</span>:5672 rabbitmq

<span class="token comment">#进容器内</span>
<span class="token function">docker</span> <span class="token function">ps</span> 
<span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> 镜像ID /bin/bash

<span class="token comment">#安装控制台</span>
rabbitmq-plugins <span class="token builtin class-name">enable</span> rabbitmq_management
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,12),y={href:"http://localhost:15672",target:"_blank",rel:"noopener noreferrer"},f=n("figure",null,[n("img",{src:"https://cdn.jsdelivr.net/gh/zhengzhenning/imageBeds@main/images/image-20240419181359991.png",alt:"rabbitmq",tabindex:"0",loading:"lazy"}),n("figcaption",null,"rabbitmq")],-1),_=n("h3",{id:"安装-idea插件",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#安装-idea插件"},[n("span",null,"安装 IDEA插件")])],-1),E={href:"https://plugins.jetbrains.com/plugin/7861-envfile",target:"_blank",rel:"noopener noreferrer"},x=e(`<h3 id="调整配置文件" tabindex="-1"><a class="header-anchor" href="#调整配置文件"><span>调整配置文件</span></a></h3><p>调整<strong>config项目</strong>下 <code>shard/*.yml</code> 的配置以及其他微服务中 <code>bootstrap.yml</code> 的配置。</p><figure><img src="https://cdn.jsdelivr.net/gh/zhengzhenning/imageBeds@main/images/image-20240423165450793.png" alt="需调整的配置文件" tabindex="0" loading="lazy"><figcaption>需调整的配置文件</figcaption></figure><p>调整内容（未全列出，参照【图：需调整的配置文件】）：</p><ul><li>实例名改为<code>IP</code>或<code>localhost</code>，如：</li></ul><div class="language-yaml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="token comment"># shared/account-service.yml</span>
<span class="token comment">## Security配置中，auth-service 改为 localhost</span>
<span class="token key atrule">accessTokenUri</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//auth<span class="token punctuation">-</span>service<span class="token punctuation">:</span>5000/uaa/oauth/token
<span class="token key atrule">accessTokenUri</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>5000/uaa/oauth/token
<span class="token comment"># shared/application.yml</span>
<span class="token comment">## Eureka配置中，registry 改为 localhost</span>
<span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//registry<span class="token punctuation">:</span>8761/eureka/
<span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>8761/eureka/
<span class="token comment">## Security配置中，auth-service 改为 localhost</span>
<span class="token key atrule">user-info-uri</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//auth<span class="token punctuation">-</span>service<span class="token punctuation">:</span>5000/uaa/users/current
<span class="token key atrule">user-info-uri</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>5000/uaa/users/current
<span class="token comment">## RabbitMQ  rabbitmq 改为 localhost</span>
<span class="token key atrule">host</span><span class="token punctuation">:</span> rabbitmq
<span class="token key atrule">host</span><span class="token punctuation">:</span> localhost
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="启动服务" tabindex="-1"><a class="header-anchor" href="#启动服务"><span>启动服务</span></a></h2><p>按照以下顺序依次启动服务，其余服务无顺序要求：</p><figure><img src="https://cdn.jsdelivr.net/gh/zhengzhenning/imageBeds@main/images/image-20240423165332440.png" alt="image-20240423165332440" tabindex="0" loading="lazy"><figcaption>image-20240423165332440</figcaption></figure>`,9),z=n("code",null,"registry",-1),B={href:"http://127.0.0.1:8761",target:"_blank",rel:"noopener noreferrer"},D=n("figure",null,[n("img",{src:"https://cdn.jsdelivr.net/gh/zhengzhenning/imageBeds@main/images/image-20240423165029152.png",alt:"image-20240423165029152",tabindex:"0",loading:"lazy"}),n("figcaption",null,"image-20240423165029152")],-1),S=n("code",null,"gateway",-1),A={href:"http://127.0.0.1:4000",target:"_blank",rel:"noopener noreferrer"},j=n("figure",null,[n("img",{src:"https://cdn.jsdelivr.net/gh/zhengzhenning/imageBeds@main/images/image-20240423165137754.png",alt:"image-20240423165137754",tabindex:"0",loading:"lazy"}),n("figcaption",null,"image-20240423165137754")],-1),w=n("h2",{id:"问题记录",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#问题记录"},[n("span",null,"问题记录")])],-1),M=n("code",null,"MongoDB",-1),U=n("code",null,"MongoSecurityException",-1),C={href:"https://howtodoinjava.com/mongodb/command-failed-with-error-18/",target:"_blank",rel:"noopener noreferrer"},R=e(`<figure><img src="https://cdn.jsdelivr.net/gh/zhengzhenning/imageBeds@main/images/image-20240419160749189.png" alt="image-20240419160749189" tabindex="0" loading="lazy"><figcaption>image-20240419160749189</figcaption></figure><p>在 <code>shared/account-service.yml</code> 指定 <code>authentication-database</code> ，且需明文指定 <code>password</code> ，默认的 <code>password: \${MONGODB_PASSWORD}</code> 在本地启动时，存在无法读取 <code>.env</code> 文件问题：</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>spring:
  data:
    mongodb:
      # 本地环境
      host: localhost
      username: user
      password: password
      database: piggymetrics
      # 指定鉴权数据库
      authentication-database: admin
      port: 27017
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>其余配置文件中，如果也有 <code>MongoDB</code> 的配置，那么也需一并改造，如以下文件均需指定 <code>authentication-database</code> 配置：</p><ul><li><code>shared/auth-service.yml</code></li><li><code>shared/statistics-service.yml</code></li></ul>`,5);function T(N,O){const a=p("ExternalLinkIcon");return i(),r("div",null,[c,n("p",null,[s("基于 "),n("a",u,[s("piggymetrics"),t(a)]),s(" 搭建微服务，以 "),d,s(" 项目为载体，达成2个目的：")]),m,g,n("ul",null,[n("li",null,[n("a",k,[s("学习Spring Cloud之本地部署"),t(a)])])]),v,n("ul",null,[n("li",null,[n("a",b,[s("https://docs.spring.io/spring-data/mongodb/docs/3.2.4/reference/html/#preface"),t(a)]),s(" mongodb版本适配")]),n("li",null,[n("a",h,[s("https://docs.spring.io/spring-data/mongodb/docs/3.2.4/reference/html/#compatibility.matrix"),t(a)]),s(" 兼容性适配")])]),q,n("p",null,[s("访问："),n("a",y,[s("http://localhost:15672"),t(a)]),s(" ， 账户/密码：guest/guest")]),f,_,n("ul",null,[n("li",null,[s("安装 "),n("a",E,[s("EnvFile"),t(a)]),s(" 插件")])]),x,n("p",null,[z,s(" 服务启动成功后，访问 "),n("a",B,[s("http://127.0.0.1:8761"),t(a)]),s(" ：")]),D,n("p",null,[S,s(" 服务启动成功后，访问 "),n("a",A,[s("http://127.0.0.1:4000"),t(a)])]),j,w,n("p",null,[s("连接 "),M,s(" 失败，报 "),U,s("，参考"),n("a",C,[s("这篇"),t(a)]),s("。")]),R])}const H=o(l,[["render",T],["__file","1架构搭建.html.vue"]]),P=JSON.parse('{"path":"/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84/1%E6%9E%B6%E6%9E%84%E6%90%AD%E5%BB%BA.html","title":"架构搭建","lang":"zh-CN","frontmatter":{"title":"架构搭建","order":2,"icon":"file","category":["微服务","架构","框架","搭建"],"description":"重要 通过 sqshq/piggymetrics 学习和了解微服务架构 Microservice Architecture with Spring Boot, Spring Cloud and Docker 基于 piggymetrics 搭建微服务，以 sqshq/piggymetrics 项目为载体，达成2个目的： 本地启动项目 容器化部署项目 参...","head":[["meta",{"property":"og:url","content":"https://mister-hope.github.io/yibu_zzn/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84/1%E6%9E%B6%E6%9E%84%E6%90%AD%E5%BB%BA.html"}],["meta",{"property":"og:site_name","content":"郑振宁的数字资产中心"}],["meta",{"property":"og:title","content":"架构搭建"}],["meta",{"property":"og:description","content":"重要 通过 sqshq/piggymetrics 学习和了解微服务架构 Microservice Architecture with Spring Boot, Spring Cloud and Docker 基于 piggymetrics 搭建微服务，以 sqshq/piggymetrics 项目为载体，达成2个目的： 本地启动项目 容器化部署项目 参..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://cdn.jsdelivr.net/gh/zhengzhenning/imageBeds@main/images/image-20240424111519244.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-04-24T08:01:35.000Z"}],["meta",{"property":"article:author","content":"郑振宁"}],["meta",{"property":"article:modified_time","content":"2024-04-24T08:01:35.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"架构搭建\\",\\"image\\":[\\"https://cdn.jsdelivr.net/gh/zhengzhenning/imageBeds@main/images/image-20240424111519244.png\\",\\"https://cdn.jsdelivr.net/gh/zhengzhenning/imageBeds@main/images/image-20240424110722680.png\\",\\"https://cdn.jsdelivr.net/gh/zhengzhenning/imageBeds@main/images/image-20240419181359991.png\\",\\"https://cdn.jsdelivr.net/gh/zhengzhenning/imageBeds@main/images/image-20240423165450793.png\\",\\"https://cdn.jsdelivr.net/gh/zhengzhenning/imageBeds@main/images/image-20240423165332440.png\\",\\"https://cdn.jsdelivr.net/gh/zhengzhenning/imageBeds@main/images/image-20240423165029152.png\\",\\"https://cdn.jsdelivr.net/gh/zhengzhenning/imageBeds@main/images/image-20240423165137754.png\\",\\"https://cdn.jsdelivr.net/gh/zhengzhenning/imageBeds@main/images/image-20240419160749189.png\\"],\\"dateModified\\":\\"2024-04-24T08:01:35.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"郑振宁\\",\\"url\\":\\"https://mister-hope.com\\"}]}"]]},"headers":[{"level":2,"title":"环境准备","slug":"环境准备","link":"#环境准备","children":[{"level":3,"title":"部署 MongDB","slug":"部署-mongdb","link":"#部署-mongdb","children":[]},{"level":3,"title":"部署 RabbitMQ","slug":"部署-rabbitmq","link":"#部署-rabbitmq","children":[]},{"level":3,"title":"安装 IDEA插件","slug":"安装-idea插件","link":"#安装-idea插件","children":[]},{"level":3,"title":"调整配置文件","slug":"调整配置文件","link":"#调整配置文件","children":[]}]},{"level":2,"title":"启动服务","slug":"启动服务","link":"#启动服务","children":[]},{"level":2,"title":"问题记录","slug":"问题记录","link":"#问题记录","children":[]}],"git":{"createdTime":1713249159000,"updatedTime":1713945695000,"contributors":[{"name":"一步","email":"zzn_workmail@163.com","commits":4}]},"readingTime":{"minutes":3.11,"words":932},"filePathRelative":"微服务架构/1架构搭建.md","localizedDate":"2024年4月16日","excerpt":"<div class=\\"hint-container important\\">\\n<p class=\\"hint-container-title\\">重要</p>\\n<p>通过 <code>sqshq/piggymetrics</code> 学习和了解微服务架构</p>\\n<p>Microservice Architecture with Spring Boot, Spring Cloud and Docker</p>\\n</div>\\n<p>基于 <a href=\\"https://github.com/sqshq/piggymetrics\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">piggymetrics</a> 搭建微服务，以  <code>sqshq/piggymetrics</code> 项目为载体，达成2个目的：</p>","autoDesc":true}');export{H as comp,P as data};
